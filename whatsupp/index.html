<!DOCTYPE html>
<html ng-app="whatsupp">
  <head>
    <meta charset="utf-8">
    <title>Playground</title>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.7/angular.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/danialfarid-angular-file-upload/12.2.12/ng-file-upload.js"></script>
  </head>
  <body ng-controller="MainCtrl as main">
    Does angular work? 1 plus 1 is: {{ 1 + 1 }}

    <form name="main.uploadForm" ng-submit="main.upload()">
      <input type="file" ngf-select="" ngf-select ng-model="main.file" name="file" ngf-max-size="20MB">
      <button type="submit">submit</button>
    </form>

    <script>
      angular
        .module("whatsupp", ['ngFileUpload'])
        .controller("MainCtrl", MainCtrl);

        MainCtrl.$inject = ['Upload'];
        function MainCtrl(Upload){
          var vm = this;
          vm.upload = function(){
            if (vm.uploadForm.file.$valid && vm.file) {
              var file = vm.file;
              console.log(file);

              Upload.upload({
                url: '/upload',
                data: { file: file }
              }).then(function (response) {
                console.log(response);
              }, function (response) {
                console.log('Error status: ' + response.status);
              }, function (evt) {
                var progressPercentage = parseInt(100.0 * evt.loaded / evt.total);
                console.log('progress: ' + progressPercentage + '% ' + evt.config.data.file.name);
              });
            }
          }

        }
    </script>
  </body>
</html>
